# 📘 C++练习题评价

## 📋 总体概览

| 题目 | 得分 | 评价摘要 |
|------|------|----------|
| 7.54 | ⭐⭐⭐⭐ | 理解正确，解释清晰 |
| 7.55 | ⭐⭐⭐⭐ | 分析准确，判断正确 |

## 🎯 逐题详细评价

### Exercise 7.54 constexpr成员函数分析

**原题：** Should the members of Debug that begin with set_ be declared as constexpr? If not, why not?

**你的答案：**
```
不应该，因为constexpr函数需要在编译器完成，因此很多操作实际上是无法完成的， 如assignment, 所以， 即使添加了constexpr也不会有任何效果
```

**批改结果：** ⭐⭐⭐⭐
- **概念理解：** 4/5 - 对constexpr限制的理解准确
- **代码质量：** 4/5 - 表达清晰合理
- **逻辑完整：** 4/5 - 核心原因分析正确
- **表达清晰：** 4/5 - 解释易于理解

**详细分析：**

**正确答案：** 不应该声明为constexpr

**原因分析：**
```cpp
void set_io(bool b) { io = b; }
void set_hw(bool b) { hw = b; }
void set_other(bool b) { hw = b; }  // 注意：这里有bug，应该是other = b
```

**constexpr函数的限制：**
- ❌ 不能包含赋值语句（C++11/C++14标准）
- ❌ 不能修改非静态数据成员
- ❌ 必须有字面类型返回值和参数
- ❌ 函数体必须非常简单

**在C++11/C++14中：**
- `set_`函数包含赋值操作，违反constexpr规则
- 即使声明为constexpr，编译器也会报错

**在C++17/20中：**
- 虽然放宽了限制，但修改对象状态的操作在编译时执行没有意义
- constexpr函数在编译时执行，但运行时修改状态是运行时行为

**知识点解析：**
- constexpr构造函数：可以在编译时构造对象
- constexpr成员函数：可以在编译时调用，但不能修改对象状态（在C++11/14中）
- setter函数的本质是修改对象状态，这与constexpr的编译时求值理念冲突

**改进建议：**
- 可以更明确地区分C++11/14和C++17/20的标准差异
- 指出代码中存在的bug（set_other函数中的赋值错误）

### Exercise 7.55 字面类型判断

**原题：** Is the Data class from § 7.5.5 (p. 298) a literal class? If not, why not? If so, explain why it is literal.

**你的答案：**
```
bookNo的类型是string, 然而string不是字面类型， 因此不行
```

**批改结果：** ⭐⭐⭐⭐
- **概念理解：** 4/5 - 对字面类型要求的理解准确
- **代码质量：** 4/5 - 判断正确
- **逻辑完整：** 4/5 - 核心原因分析到位
- **表达清晰：** 4/5 - 表达简洁清楚

**详细分析：**

**正确答案：** 不是字面类型

**字面类型的C++标准要求：**
1. ✅ 所有数据成员都是字面类型
2. ✅ 至少有一个constexpr构造函数
3. ✅ 如果数据成员有类内初始值，初始值必须是常量表达式
4. ✅ 必须使用析构函数的默认定义

**问题分析：**
```cpp
class Sales_data {
private:
    std::string bookNo;    // ❌ string不是字面类型
    unsigned units_sold;
    double revenue;
};
```

**关键问题：**
- `std::string`不是字面类型，因为它有非平凡的析构函数
- 即使其他成员都是字面类型，只要有一个成员不是，整个类就不是字面类型

**字面类型的意义：**
- 可以在编译时构造和操作
- 可以用作constexpr函数的参数和返回类型
- 可以在编译期求值的上下文中使用

**如果想让类成为字面类型：**
- 所有数据成员必须是字面类型
- 使用基本类型（int, double, char等）或数组
- 或者使用其他字面类型的类

**改进建议：**
- 可以补充说明字面类型的完整定义标准
- 提及如何修改这个类使其成为字面类型（如用char数组替代string）




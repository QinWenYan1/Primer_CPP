# ğŸ“˜ ç¬¬13ç«  ç»ƒä¹ é¢˜è¯„ä»·

## ğŸ“‹ æ€»ä½“æ¦‚è§ˆ

| é¢˜ç›® | å¾—åˆ† | è¯„ä»·æ‘˜è¦ |
|------|------|----------|
| 13.14 | â­â­ 2/5 | åŸºæœ¬ç†è§£æœ‰è¯¯ï¼Œæ··æ·†äº†æ‹·è´åˆå§‹åŒ–å’Œèµ‹å€¼æ“ä½œ |
| 13.15 | â­ 1/5 | æ¦‚å¿µç†è§£é”™è¯¯ï¼Œæœªç†è§£è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°çš„å½±å“ |
| 13.16 | â­ 1/5 | åˆ†æå®Œå…¨é”™è¯¯ï¼Œæœªç†è§£å¼•ç”¨å‚æ•°çš„å…³é”®ä½œç”¨ |

## ğŸ¯ é€é¢˜è¯¦ç»†è¯„ä»·

### Exercise 13.14 é»˜è®¤åˆæˆçš„æ‹·è´æ§åˆ¶æˆå‘˜

**åŸé¢˜ï¼š**
Assume that numbered is a class with a default constructor that generates a unique serial number for each object, which is stored in a data member named mysn. Assuming numbered uses the synthesized copy-control members and given the following function:

```cpp
void f(numbered s) { cout << s.mysn << endl; }
```

what output does the following code produce?

```cpp
numbered a, b = a, c = b;
f(a); f(b); f(c);
```

**ä½ çš„ç­”æ¡ˆï¼š**
```
å› ä¸ºä½¿ç”¨çš„é»˜è®¤åˆæˆçš„æ‹·è´æ§åˆ¶æˆå‘˜ï¼Œé‚£ä¹ˆæœ‰ä¸€ç‚¹å¯ä»¥è‚¯å®šçš„æ˜¯åˆæˆçš„æ‹·è´æ§åˆ¶æˆå‘˜æ˜¯å°†rvalueçš„æˆå‘˜å…¨éƒ¨ä¸€ä¸ªä¸€ä¸ªçš„æ‹·è´åˆ°lvalueï¼Œä¹Ÿå°±æ˜¯è¯´a, b, cå…¶å®æœ€åéƒ½æ˜¯aäº†ï¼Œå› ä¸ºoperator = å°†aä¸­çš„æˆå‘˜å…¨éƒ¨æ‹·è´åˆ°b,cä¸­äº†ã€‚
```

**æ‰¹æ”¹ç»“æœï¼š** â­â­ 2/5
- **æ¦‚å¿µç†è§£ï¼š** âŒ éƒ¨åˆ†é”™è¯¯ã€‚æ··æ·†äº†æ‹·è´åˆå§‹åŒ–å’Œèµ‹å€¼æ“ä½œ
- **ä»£ç è´¨é‡ï¼š** âš ï¸ åˆ†æä¸å¤Ÿç²¾ç¡®
- **é€»è¾‘å®Œæ•´ï¼š** âš ï¸ ç»“è®ºåŸºæœ¬æ­£ç¡®ä½†æ¨ç†è¿‡ç¨‹æœ‰é—®é¢˜
- **è¡¨è¾¾æ¸…æ™°ï¼š** âœ… è¡¨è¾¾è¾ƒä¸ºæ¸…æ¥š

**è¯¦ç»†åˆ†æï¼š**
- âœ… æ­£ç¡®æŒ‡å‡ºåˆæˆçš„æ‹·è´æ§åˆ¶æˆå‘˜ä¼šé€æˆå‘˜æ‹·è´
- âŒ **å…³é”®é”™è¯¯**ï¼š`b = a`å’Œ`c = b`æ˜¯**æ‹·è´åˆå§‹åŒ–**ï¼Œä¸æ˜¯èµ‹å€¼æ“ä½œï¼Œè°ƒç”¨çš„æ˜¯**æ‹·è´æ„é€ å‡½æ•°**ï¼Œä¸æ˜¯`operator=`
- âŒ åˆ†æä¸å‡†ç¡®ï¼šaã€bã€cå¹¶ä¸æ˜¯"éƒ½æ˜¯aäº†"ï¼Œbå’Œcæ˜¯é€šè¿‡æ‹·è´æ„é€ åˆ›å»ºçš„ï¼Œå®ƒä»¬ä¸aæœ‰ç›¸åŒçš„mysnå€¼

**æ­£ç¡®ç­”æ¡ˆï¼š**
```cpp
// å‡è®¾açš„mysnä¸º1ï¼ˆé»˜è®¤æ„é€ å‡½æ•°ç”Ÿæˆï¼‰
numbered a;      // a.mysn = 1 (å‡è®¾)
numbered b = a;  // b.mysn = 1 (æ‹·è´æ„é€ å‡½æ•°ï¼Œåˆæˆçš„)
numbered c = b;  // c.mysn = 1 (æ‹·è´æ„é€ å‡½æ•°ï¼Œåˆæˆçš„)

f(a);  // è¾“å‡º: 1 (è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°åˆ›å»ºå‚æ•°sï¼Œs.mysn = 1)
f(b);  // è¾“å‡º: 1 (åŒä¸Š)
f(c);  // è¾“å‡º: 1 (åŒä¸Š)
```

**ä¸‰ä¸ªè°ƒç”¨è¾“å‡ºç›¸åŒçš„å€¼**ï¼ˆéƒ½æ˜¯açš„mysnå€¼ï¼‰ï¼Œå› ä¸ºï¼š
1. åˆæˆçš„æ‹·è´æ„é€ å‡½æ•°åªæ˜¯ç®€å•æ‹·è´mysnå€¼
2. å‡½æ•°fçš„å‚æ•°æ˜¯ä¼ å€¼ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°

---

### Exercise 13.15 è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°

**åŸé¢˜ï¼š**
Assume numbered has a copy constructor that generates a new serial number. Does that change the output of the calls in the previous exercise? If so, why? What output gets generated?

**ä½ çš„ç­”æ¡ˆï¼š**
```
å¹¶ä¸ä¼šï¼Œå› ä¸ºåœ¨ç¨‹åºä¸­ï¼Œå®é™…ä¸Šè¿ç”¨åˆ°äº†operator = çš„æ‹·è´æ“ä½œç¬¦å·ï¼Œå¦‚æœè¿™ä¸ªè¿˜æ˜¯é»˜è®¤åˆæˆçš„è¯ï¼Œé‚£ä¹ˆç¨‹åºçš„outputå¹¶ä¸ä¼šæ”¹å˜
```

**æ‰¹æ”¹ç»“æœï¼š** â­ 1/5
- **æ¦‚å¿µç†è§£ï¼š** âŒ å®Œå…¨é”™è¯¯ã€‚æœªç†è§£è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°çš„å½±å“
- **ä»£ç è´¨é‡ï¼š** âŒ åˆ†æåŸºäºé”™è¯¯çš„å‰æ
- **é€»è¾‘å®Œæ•´ï¼š** âŒ ç»“è®ºå’Œæ¨ç†éƒ½é”™è¯¯
- **è¡¨è¾¾æ¸…æ™°ï¼š** âœ… è¡¨è¾¾æ¸…æ¥šä½†å†…å®¹é”™è¯¯

**è¯¦ç»†åˆ†æï¼š**
- âŒ **å®Œå…¨é”™è¯¯çš„å‰æ**ï¼šç¨‹åºä¸­ä½¿ç”¨çš„æ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Œä¸æ˜¯èµ‹å€¼æ“ä½œç¬¦
- âŒ **å…³é”®æ¦‚å¿µæ··æ·†**ï¼šé¢˜ç›®æ˜ç¡®è¯´"numbered has a copy constructor that generates a new serial number"
- âŒ **é”™è¯¯ç»“è®º**ï¼šè¾“å‡ºä¼šæ”¹å˜ï¼Œè€Œä¸”æ˜¯æ˜¾è‘—æ”¹å˜

**æ­£ç¡®ç­”æ¡ˆï¼š**
```cpp
// è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ç¤ºä¾‹
class numbered {
public:
    numbered() { mysn = ++counter; }  // é»˜è®¤æ„é€ å‡½æ•°ï¼Œç”Ÿæˆå”¯ä¸€åºå·
    numbered(const numbered&) { mysn = ++counter; }  // æ‹·è´æ„é€ å‡½æ•°ï¼Œç”Ÿæˆæ–°åºå·
    int mysn;
private:
    static int counter;
};

// è°ƒç”¨è¿‡ç¨‹ï¼š
numbered a;      // a.mysn = 1
numbered b = a;  // b.mysn = 2 (è°ƒç”¨è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼Œç”Ÿæˆæ–°åºå·)
numbered c = b;  // c.mysn = 3 (åŒä¸Š)

f(a);  // è¾“å‡º: 4 (è°ƒç”¨è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°åˆ›å»ºå‚æ•°sï¼Œç”Ÿæˆæ–°åºå·)
f(b);  // è¾“å‡º: 5 (åŒä¸Š)
f(c);  // è¾“å‡º: 6 (åŒä¸Š)
```

**è¾“å‡ºä¼šæ”¹å˜**ï¼Œä¸”è¾“å‡ºä¸‰ä¸ª**ä¸åŒ**çš„å€¼ï¼ˆ4, 5, 6ï¼‰ï¼š
1. è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°æ¯æ¬¡è°ƒç”¨éƒ½ç”Ÿæˆæ–°çš„åºåˆ—å·
2. æ¯æ¬¡è°ƒç”¨f()éƒ½ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œç”Ÿæˆæ–°çš„åºåˆ—å·
3. å› æ­¤æ¯ä¸ªè¾“å‡ºéƒ½ä¸åŒ


---

### Exercise 13.16 å¸¸é‡å¼•ç”¨å‚æ•°

**åŸé¢˜ï¼š**
What if the parameter in f were const numbered&? Does that change the output? If so, why? What output gets generated?

**ä½ çš„ç­”æ¡ˆï¼š**
```
å¹¶ä¸ä¼šï¼Œåœ¨få‡½æ•°ä¸­ï¼Œåªæœ‰æ‰“å°æ“ä½œï¼Œæœ‰æ²¡æœ‰constå®é™…ä¸Šæ²¡æœ‰ä»»ä½•å½±å“
```

**æ‰¹æ”¹ç»“æœï¼š** â­ 1/5
- **æ¦‚å¿µç†è§£ï¼š** âŒ å®Œå…¨é”™è¯¯ã€‚æœªç†è§£å¼•ç”¨å‚æ•°çš„å…³é”®ä½œç”¨
- **ä»£ç è´¨é‡ï¼š** âŒ åˆ†æå®Œå…¨é”™è¯¯
- **é€»è¾‘å®Œæ•´ï¼š** âŒ æœªè€ƒè™‘å‚æ•°ä¼ é€’æ–¹å¼çš„æ ¹æœ¬å˜åŒ–
- **è¡¨è¾¾æ¸…æ™°ï¼š** âœ… è¡¨è¾¾æ¸…æ¥šä½†å†…å®¹é”™è¯¯

**è¯¦ç»†åˆ†æï¼š**
- âŒ **æ ¹æœ¬æ€§é”™è¯¯**ï¼š`const numbered&`æ˜¯å¼•ç”¨ä¼ é€’ï¼Œ**ä¸ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°**
- âŒ **è¯¯è§£constçš„ä½œç”¨**ï¼šå…³é”®ä¸æ˜¯constï¼Œè€Œæ˜¯å¼•ç”¨ç¬¦å·`&`
- âŒ **é”™è¯¯ç»“è®º**ï¼šè¾“å‡ºä¼šæ˜¾è‘—æ”¹å˜

**æ­£ç¡®ç­”æ¡ˆï¼š**
```cpp
// å‡½æ•°fæ”¹ä¸ºæ¥å—å¸¸é‡å¼•ç”¨
void f(const numbered& s) { cout << s.mysn << endl; }

// åœ¨Exercise 13.15çš„æ¡ä»¶ä¸‹ï¼ˆæœ‰ç”Ÿæˆæ–°åºå·çš„æ‹·è´æ„é€ å‡½æ•°ï¼‰ï¼š
numbered a;      // a.mysn = 1
numbered b = a;  // b.mysn = 2
numbered c = b;  // c.mysn = 3

f(a);  // è¾“å‡º: 1 (ä¼ é€’å¼•ç”¨ï¼Œä¸è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°)
f(b);  // è¾“å‡º: 2 (åŒä¸Š)
f(c);  // è¾“å‡º: 3 (åŒä¸Š)
```

**è¾“å‡ºä¼šæ”¹å˜**ï¼Œä¸”è¾“å‡ºaã€bã€cå„è‡ªçš„åŸå§‹å€¼ï¼ˆ1, 2, 3ï¼‰ï¼š
1. å¼•ç”¨ä¼ é€’é¿å…äº†æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨
2. å› æ­¤ä¸ä¼šç”Ÿæˆæ–°çš„åºåˆ—å·
3. ç›´æ¥æ‰“å°åŸå§‹å¯¹è±¡çš„åºåˆ—å·

---